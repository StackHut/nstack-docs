<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Direct JSON-RPC Usage &mdash; StackHut 0.1.x documentation</title>
    
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.1.x',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="StackHut 0.1.x documentation" href="../index.html" />
    <link rel="up" title="Using a Service" href="index.html" />
    <link rel="next" title="Service Management" href="../service_mgmt/index.html" />
    <link rel="prev" title="Client-side Libraries" href="client_libs.html" />
   
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9">

  </head>
  <body role="document">  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="direct-json-rpc-usage">
<span id="using-json-rpc"></span><h1>Direct JSON-RPC Usage<a class="headerlink" href="#direct-json-rpc-usage" title="Permalink to this headline">Â¶</a></h1>
<p>This involves creating JSON-RPC compatible requests on demand, thankfully this is very simple and so it&#8217;s easy to call your StackHut services from anywhere.
It can then be accessed in the cloud via <a class="reference external" href="http://www.jsonrpc.org/">JSON-RPC</a> transported over a HTTP(S) POST request.
To make it easier to call and use StackHut services we have started building client-libraries in several languages. They are described further in <a class="reference internal" href="client_libs.html#using-client-libs"><span>Client-side Libraries</span></a>, and currently exist for Python and JavaScript.</p>
<p>However it&#8217;s always possible to construct the JSON-RPC request yourself in any langauge to consume a StackHut service - thankfully JSON-RPC is a very simple protocol, as shown in <a class="reference internal" href="#using-json-rpc"><span>Direct JSON-RPC Usage</span></a>, and this is much simpler than it sounds!</p>
<p>Request:</p>
<div class="highlight-JSON"><div class="highlight"><pre><span class="p">{</span>
    <span class="nt">&quot;service&quot;</span> <span class="p">:</span> <span class="s2">&quot;mands/demo-python&quot;</span><span class="p">,</span>
    <span class="nt">&quot;req&quot;</span> <span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;method&quot;</span> <span class="p">:</span> <span class="s2">&quot;add&quot;</span><span class="p">,</span>
        <span class="nt">&quot;params&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
        <span class="s2">&quot;id&quot;</span> <span class="p">:</span> <span class="mi">1</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In the above request, we call the method <code class="docutils literal"><span class="pre">add</span></code> from the StackHut service <code class="docutils literal"><span class="pre">mands/demo-python</span></code> with two parameter, the numbers 2, and 2.
<code class="docutils literal"><span class="pre">params</span></code> is a JSON list that can contain any JSON types, i.e. floats, strings, lists and objects. The types expected by the method are defined by the service and are shown on API section of the <a class="reference external" href="https://stackhut.com/#/u/mands/demo-python">services page</a>. The types of the request are checked and an error will be returned if they do not match.
The <code class="docutils literal"><span class="pre">id</span></code> element is optional and will be added automatically if not present.</p>
<p>We can perform this call by simply sending a HTTP POST request, with content-type <code class="docutils literal"><span class="pre">application/json</span></code> to <code class="docutils literal"><span class="pre">https://api.stackhut.com/run</span></code>. Let&#8217;s save the above example as <code class="docutils literal"><span class="pre">test_request.json</span></code> and demonstrate this using the fantastic tool <a class="reference external" href="https://github.com/jkbrzt/httpie">httpie</a>,</p>
<div class="highlight-bash"><div class="highlight"><pre>http POST https://api.stackhut.com/run @./test_request.json
</pre></div>
</div>
<p>This will make the request and on completion will output a bunch of things to your terminal, including a response body similar to the following,</p>
<div class="highlight-JSON"><div class="highlight"><pre><span class="p">{</span>
    <span class="nt">&quot;response&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;f335bc80-4289-4599-b655-55341b40bd1a&quot;</span><span class="p">,</span>
        <span class="nt">&quot;jsonrpc&quot;</span><span class="p">:</span> <span class="s2">&quot;2.0&quot;</span><span class="p">,</span>
        <span class="nt">&quot;result&quot;</span><span class="p">:</span> <span class="mi">4</span>
    <span class="p">},</span>
    <span class="nt">&quot;taskId&quot;</span><span class="p">:</span> <span class="s2">&quot;d2e186d6-e746-4a4f-bb76-b39185e588d5&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">response</span></code> object is the JSON-RPC response, containing the return value in the <code class="docutils literal"><span class="pre">result</span></code> field - in this case the number 4 (we created all this to show 2 + 2 = 4 - but now in the cloud! :)). The <code class="docutils literal"><span class="pre">id</span></code> element is also present, to aid linking requests to repsonses, and there is also a top-level <code class="docutils literal"><span class="pre">taskId</span></code> element to uniquely represent this individual request.</p>
<p>Let&#8217;s try and call the service method <code class="docutils literal"><span class="pre">multiply</span></code> but with two strings, rather than two numbers as expected. We&#8217;ll edit the <code class="docutils literal"><span class="pre">test_request.json</span></code> as follows,</p>
<div class="highlight-JSON"><div class="highlight"><pre><span class="p">{</span>
    <span class="nt">&quot;service&quot;</span> <span class="p">:</span> <span class="s2">&quot;mands/demo-python&quot;</span><span class="p">,</span>
    <span class="nt">&quot;req&quot;</span> <span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;method&quot;</span> <span class="p">:</span> <span class="s2">&quot;multiply&quot;</span><span class="p">,</span>
        <span class="nt">&quot;params&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&quot;two&quot;</span><span class="p">,</span> <span class="s2">&quot;three&quot;</span><span class="p">],</span>
        <span class="nt">&quot;id&quot;</span> <span class="p">:</span> <span class="mi">1</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>and run,:</p>
<div class="highlight-python"><div class="highlight"><pre>http POST https://api.stackhut.com/run @./test_request.json
</pre></div>
</div>
<p>returning,</p>
<div class="highlight-JSON"><div class="highlight"><pre><span class="p">{</span>
    <span class="nt">&quot;response&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;error&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;code&quot;</span><span class="p">:</span> <span class="mi">-32602</span><span class="p">,</span>
            <span class="nt">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;Function &#39;Default.multiply&#39; invalid param &#39;x&#39;. &#39;two&#39; is of type &lt;class &#39;str&#39;&gt;, expected int&quot;</span>
        <span class="p">},</span>
        <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;d15a719a-70e3-4643-87d2-92cb7157bb81&quot;</span><span class="p">,</span>
        <span class="nt">&quot;jsonrpc&quot;</span><span class="p">:</span> <span class="s2">&quot;2.0&quot;</span>
    <span class="p">},</span>
    <span class="nt">&quot;taskId&quot;</span><span class="p">:</span> <span class="s2">&quot;c405cb17-0d57-4aee-804b-ad29edad3000&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>As before we receive a JSON-RPC response object, however this time the <code class="docutils literal"><span class="pre">result</span></code> field has been replaced with an <code class="docutils literal"><span class="pre">error</span></code> field, an object with an error code, a human readable text message, and an optional <code class="docutils literal"><span class="pre">data</span></code> sub-object with further information. You can use this data to handle the error as required within your code</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The error codes are as those defined by the <a class="reference external" href="http://www.jsonrpc.org/specification#error_object">JSON-RPC spec</a>.</p>
</div>
<p>We hope this shows how you can call any StackHut service from your code - you may either use an existing JSON-RPC library or roll your own functions to make the request and handle the response respectively.</p>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">Using a Service</a><ul>
      <li>Previous: <a href="client_libs.html" title="previous chapter">Client-side Libraries</a></li>
      <li>Next: <a href="../service_mgmt/index.html" title="next chapter">Service Management</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/using_service/json_rpc.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2015, StackHut.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.3.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.6</a>
      
      |
      <a href="../_sources/using_service/json_rpc.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>